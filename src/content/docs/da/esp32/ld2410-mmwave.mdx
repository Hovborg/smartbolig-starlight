---
title: LD2410 mmWave Presence Sensor med ESPHome
description: Byg din egen pÃ¥lidelige tilstedevÃ¦relsessensor med LD2410 mmWave radar og ESP32. Detekterer selv stillestÃ¥ende personer.
---

import { Steps, Aside, Tabs, TabItem, Card, CardGrid, Badge } from '@astrojs/starlight/components';

<Badge text="Medium" variant="caution" /> <Badge text="45 min" variant="note" />

<img src="/images/guides/ld2410-mmwave/hero.jpg" alt="LD2410 mmWave radar sensor" style="border-radius: 12px; margin-bottom: 1.5rem;" />

LD2410 er en mmWave radar sensor der kan detektere menneskelig tilstedevÃ¦relse - selv nÃ¥r du sidder helt stille. Perfekt til badevÃ¦relse, kontor eller andre rum hvor PIR sensorer fejler.

## ğŸ¤” Hvorfor mmWave frem for PIR?

![LD2410 mmWave oversigt](/images/guides/ld2410-mmwave/overview.svg)

| Feature | PIR Sensor | mmWave (LD2410) |
|---------|------------|-----------------|
| **BevÃ¦gelse** | âœ… Ja | âœ… Ja |
| **StillestÃ¥ende person** | âŒ Nej | âœ… Ja (detekterer vejrtrÃ¦kning) |
| **Gennem glas/plastik** | âŒ Nej | âœ… Ja |
| **AfstandsmÃ¥ling** | âŒ Nej | âœ… Ja |
| **Falske positiver** | Mange | FÃ¥ (med tuning) |
| **Pris** | ~20 kr | ~50 kr |

<Aside type="tip" title="Perfekt til badevÃ¦relset">
PIR sensorer slukker lyset mens du sidder pÃ¥ toilettet. mmWave detekterer din vejrtrÃ¦kning og holder lyset tÃ¦ndt!
</Aside>

## ğŸ“¦ Hvad du skal bruge

### Hardware

| Komponent | Model | Pris ca. |
|-----------|-------|----------|
| **mmWave sensor** | HiLink LD2410C (anbefalet) | 40-60 kr |
| **Microcontroller** | ESP32 eller ESP8266 (D1 Mini) | 30-50 kr |
| **Ledninger** | Dupont jumper wires | 10 kr |
| **USB kabel** | Micro USB til strÃ¸m | 20 kr |
| **Kabinet** | 3D printet eller kÃ¸bt | 0-50 kr |
| **Total** | | **~100-200 kr** |

### LD2410 versioner

| Model | Pins | Bluetooth | Anbefaling |
|-------|------|-----------|------------|
| **LD2410** | 1.25mm (krÃ¦ver adapter) | Nej | âš ï¸ SvÃ¦r at lodde |
| **LD2410B** | 1.25mm (krÃ¦ver adapter) | Ja | âš ï¸ SvÃ¦r at lodde |
| **LD2410C** | 2.54mm standard | Ja | âœ… **Anbefalet** |

<Aside type="caution" title="VÃ¦lg LD2410C!">
LD2410C har standard 2.54mm pins som passer direkte til Dupont ledninger. De andre versioner krÃ¦ver specielle adaptere eller lodning.
</Aside>

## âš¡ Ledningsdiagram

### ESP32 til LD2410C

```
ESP32           LD2410C
â”€â”€â”€â”€â”€           â”€â”€â”€â”€â”€â”€â”€
3.3V    â”€â”€â”€â”€â”€â”€â”€  VCC
GND     â”€â”€â”€â”€â”€â”€â”€  GND  
GPIO16  â”€â”€â”€â”€â”€â”€â”€  TX (RX pÃ¥ ESP)
GPIO17  â”€â”€â”€â”€â”€â”€â”€  RX (TX pÃ¥ ESP)
```

### ESP8266 (D1 Mini) til LD2410C

```
D1 Mini         LD2410C
â”€â”€â”€â”€â”€â”€â”€         â”€â”€â”€â”€â”€â”€â”€
3.3V    â”€â”€â”€â”€â”€â”€â”€  VCC
GND     â”€â”€â”€â”€â”€â”€â”€  GND
D7 (RX) â”€â”€â”€â”€â”€â”€â”€  TX
D8 (TX) â”€â”€â”€â”€â”€â”€â”€  RX
```

<Aside type="caution" title="RX og TX krydses!">
Husk at RX pÃ¥ ESP forbindes til TX pÃ¥ LD2410 og omvendt. Det er sÃ¥dan seriel kommunikation virker.
</Aside>

## ğŸ”§ ESPHome Konfiguration

### Basis opsÃ¦tning

```yaml
# ld2410-presence.yaml
substitutions:
  device_name: "ld2410-toilet"
  friendly_name: "Toilet Presence"

esphome:
  name: ${device_name}
  friendly_name: ${friendly_name}

esp32:
  board: esp32dev
  # Eller for D1 Mini ESP8266:
  # esp8266:
  #   board: d1_mini

# WiFi
wifi:
  ssid: !secret wifi_ssid
  password: !secret wifi_password

# Enable logging
logger:
  baud_rate: 0  # Vigtigt! Disable serial logging

# Home Assistant API
api:
  encryption:
    key: !secret api_encryption_key

ota:
  platform: esphome
  password: !secret ota_password

# UART til LD2410
uart:
  id: ld2410_uart
  tx_pin: GPIO17  # Eller D8 for D1 Mini
  rx_pin: GPIO16  # Eller D7 for D1 Mini
  baud_rate: 256000
  parity: NONE
  stop_bits: 1

# LD2410 sensor
ld2410:
  id: ld2410_sensor
  uart_id: ld2410_uart
```

### Binary Sensors (TilstedevÃ¦relse)

```yaml
binary_sensor:
  # Hovedsensor - er der nogen i rummet?
  - platform: ld2410
    has_target:
      name: "${friendly_name} TilstedevÃ¦relse"
      device_class: occupancy
    
    has_moving_target:
      name: "${friendly_name} BevÃ¦gelse"
      device_class: motion
    
    has_still_target:
      name: "${friendly_name} StillestÃ¥ende"
      device_class: occupancy
```

### Afstandssensorer

```yaml
sensor:
  # Afstand til mÃ¥l
  - platform: ld2410
    moving_distance:
      name: "${friendly_name} BevÃ¦gende Afstand"
      unit_of_measurement: "cm"
    
    still_distance:
      name: "${friendly_name} StillestÃ¥ende Afstand"
      unit_of_measurement: "cm"
    
    detection_distance:
      name: "${friendly_name} Detektionsafstand"
      unit_of_measurement: "cm"
    
    # Energi-niveauer (til tuning)
    moving_energy:
      name: "${friendly_name} BevÃ¦gende Energi"
    
    still_energy:
      name: "${friendly_name} StillestÃ¥ende Energi"
```

### Tuning via Home Assistant

```yaml
# Gate thresholds (justerbar via HA)
number:
  - platform: ld2410
    timeout:
      name: "${friendly_name} Timeout"
    
    max_move_distance_gate:
      name: "${friendly_name} Max BevÃ¦gelsesafstand"
    
    max_still_distance_gate:
      name: "${friendly_name} Max StillestÃ¥ende Afstand"
    
    # Gate 0-8 thresholds
    g0_move_threshold:
      name: "${friendly_name} G0 BevÃ¦gelse Threshold"
    g0_still_threshold:
      name: "${friendly_name} G0 Still Threshold"
    # ... gentag for g1-g8

# Engineering mode switch
switch:
  - platform: ld2410
    engineering_mode:
      name: "${friendly_name} Engineering Mode"
    bluetooth:
      name: "${friendly_name} Bluetooth"
```

## ğŸ“Š Komplet konfiguration (copy-paste klar)

Her er den komplette konfiguration jeg bruger i mit toilet:

```yaml
# toilet-presence.yaml - Komplet LD2410 opsÃ¦tning
substitutions:
  device_name: "d1-mini-toilet"
  friendly_name: "Toilet"

esphome:
  name: ${device_name}
  friendly_name: ${friendly_name}

esp8266:
  board: d1_mini

wifi:
  ssid: !secret wifi_ssid
  password: !secret wifi_password
  
  ap:
    ssid: "${device_name}-AP"
    password: "12345678"

captive_portal:

logger:
  baud_rate: 0

api:
  encryption:
    key: !secret api_encryption_key

ota:
  platform: esphome
  password: !secret ota_password

# UART
uart:
  id: ld2410_uart
  tx_pin: D8
  rx_pin: D7
  baud_rate: 256000
  parity: NONE
  stop_bits: 1

# LD2410
ld2410:
  id: ld2410_sensor
  uart_id: ld2410_uart
  # Optimerede indstillinger til toilet
  timeout: 5s
  max_move_distance: 3m
  max_still_distance: 2.25m
  # Gate thresholds (0 = tÃ¦ttest, 8 = lÃ¦ngst vÃ¦k)
  g0_move_threshold: 50
  g0_still_threshold: 20
  g1_move_threshold: 50
  g1_still_threshold: 20
  g2_move_threshold: 40
  g2_still_threshold: 20
  g3_move_threshold: 40
  g3_still_threshold: 30
  g4_move_threshold: 40
  g4_still_threshold: 40
  g5_move_threshold: 40
  g5_still_threshold: 40
  g6_move_threshold: 30
  g6_still_threshold: 40
  g7_move_threshold: 30
  g7_still_threshold: 40
  g8_move_threshold: 30
  g8_still_threshold: 40

binary_sensor:
  - platform: ld2410
    has_target:
      name: "${friendly_name} TilstedevÃ¦relse"
      id: presence
      device_class: occupancy
    has_moving_target:
      name: "${friendly_name} BevÃ¦gelse"
      device_class: motion
    has_still_target:
      name: "${friendly_name} StillestÃ¥ende"
      device_class: occupancy

sensor:
  - platform: ld2410
    detection_distance:
      name: "${friendly_name} Afstand"
    moving_energy:
      name: "${friendly_name} BevÃ¦gelse Energi"
      internal: true
    still_energy:
      name: "${friendly_name} Still Energi"
      internal: true

  # WiFi signal
  - platform: wifi_signal
    name: "${friendly_name} WiFi Signal"
    update_interval: 60s

switch:
  - platform: ld2410
    engineering_mode:
      name: "${friendly_name} Engineering Mode"
      internal: true

button:
  - platform: restart
    name: "${friendly_name} Genstart"
```

## ğŸ¯ Kalibrering

### Trin 1: Aktiver Engineering Mode

<Steps>
1. I Home Assistant, find din LD2410 enhed
2. Aktiver **Engineering Mode** switchen
3. Nu kan du se energi-vÃ¦rdier for hver gate
</Steps>

### Trin 2: ObservÃ©r energi-niveauer

```yaml
# Hvad gatene betyder:
# Gate 0: 0 - 0.75m fra sensor
# Gate 1: 0.75 - 1.5m
# Gate 2: 1.5 - 2.25m
# Gate 3: 2.25 - 3m
# ... osv op til Gate 8
```

### Trin 3: JustÃ©r thresholds

**Tommelfingerregel:**
- **Move threshold**: SÃ¦t 10-20 over det du ser nÃ¥r rummet er tomt
- **Still threshold**: SÃ¦t 5-10 over baseline
- **Lavere = mere fÃ¸lsom** (flere false positives)
- **HÃ¸jere = mindre fÃ¸lsom** (kan misse tilstedevÃ¦relse)

<Aside type="tip" title="Start konservativt">
Start med hÃ¸je thresholds (40-50) og sÃ¦nk gradvist indtil sensoren detekterer pÃ¥lideligt uden false positives.
</Aside>

## ğŸ¤– Automationer

### Toilet lys automation

```yaml
automation:
  - alias: "Toilet lys ON ved tilstedevÃ¦relse"
    trigger:
      - platform: state
        entity_id: binary_sensor.toilet_tilstedevaerelse
        to: "on"
    action:
      - service: light.turn_on
        target:
          entity_id: light.toilet
        data:
          brightness_pct: 100

  - alias: "Toilet lys OFF nÃ¥r tom"
    trigger:
      - platform: state
        entity_id: binary_sensor.toilet_tilstedevaerelse
        to: "off"
        for:
          seconds: 30  # Vent 30 sek efter sidste detektion
    action:
      - service: light.turn_off
        target:
          entity_id: light.toilet
```

### Kombiner med fugtighed (ventilator)

```yaml
automation:
  - alias: "Ventilator ON ved tilstedevÃ¦relse + hÃ¸j fugt"
    trigger:
      - platform: numeric_state
        entity_id: sensor.toilet_humidity
        above: 70
    condition:
      - condition: state
        entity_id: binary_sensor.toilet_tilstedevaerelse
        state: "on"
    action:
      - service: fan.turn_on
        target:
          entity_id: fan.toilet_ventilator
```

## ğŸ”§ Fejlfinding

<Aside type="tip" title="Ingen data fra sensor?">
1. Tjek at `baud_rate: 256000` er sat korrekt
2. Tjek at `logger: baud_rate: 0` er sat (frigÃ¸r UART)
3. Verificer RX/TX er krydset korrekt
4. PrÃ¸v at bytte RX og TX pins
</Aside>

<Aside type="tip" title="For mange false positives?">
- UndgÃ¥ at pege sensoren mod vinduer (bevÃ¦gelse udenfor)
- UndgÃ¥ metal/spejle der reflekterer signalet
- HÃ¦v threshold vÃ¦rdierne
- Reducer max_distance til rummets stÃ¸rrelse
</Aside>

<Aside type="tip" title="Detekterer ikke stillestÃ¥ende person?">
- SÃ¦nk still_threshold vÃ¦rdier
- Tjek at sensoren peger mod personen (ikke parallelt)
- Aktiver engineering mode og observer still_energy
</Aside>

<Aside type="tip" title="Sensor resetter konstant?">
- ESP8266 kan have strÃ¸mproblemer - prÃ¸v ESP32
- Brug en god USB strÃ¸mforsyning (5V 1A minimum)
- TilfÃ¸j en 100ÂµF kondensator pÃ¥ VCC/GND
</Aside>

## ğŸ“ Placering tips

| Placering | Anbefaling |
|-----------|------------|
| **HÃ¸jde** | 1.5-2m over gulv |
| **Vinkel** | Peg nedad i 15-30Â° vinkel |
| **UndgÃ¥** | Direkte mod vinduer/dÃ¸re |
| **Afstand** | Max 6m effektiv rÃ¦kkevidde |

## ğŸš€ NÃ¦ste skridt

<CardGrid>
  <Card title="ğŸ  Better Thermostat" icon="setting">
    Kombiner tilstedevÃ¦relse med intelligent varmestyring.
    
    [OpsÃ¦t Better Thermostat â†’](/da/home-assistant/better-thermostat/)
  </Card>
  <Card title="âš¡ Automationer" icon="rocket">
    Lav flere automationer baseret pÃ¥ tilstedevÃ¦relse.
    
    [Din fÃ¸rste automation â†’](/da/home-assistant/foerste-automation/)
  </Card>
</CardGrid>
