---
title: BevÃ¦gelsessensor med ESP32
description: Byg en bevÃ¦gelsessensor med ESP32 og PIR sensor til automatisk lysstyring.
sidebar:
  badge:
    text: Let
    variant: success
---

import { Steps, Aside, Card, CardGrid, Tabs, TabItem, Badge } from '@astrojs/starlight/components';

<Badge text="Let" variant="success" /> <Badge text="20 min" variant="note" /> <Badge text="65 kr" variant="caution" />


PIR sensorer er perfekte til at detektere bevÃ¦gelse. TÃ¦nd lys automatisk, fÃ¥ besked nÃ¥r nogen kommer hjem, eller byg et simpelt alarmsystem.

## ğŸ“‹ ForudsÃ¦tninger

- âœ… [ESP32 sat op med ESPHome](/da/esp32/kom-godt-i-gang/)
- âœ… Home Assistant kÃ¸rende

## ğŸ›’ Komponenter

| Del | Beskrivelse | Pris ca. |
|-----|-------------|----------|
| ESP32 DevKit | WiFi mikrocontroller | 45 kr |
| HC-SR501 PIR | BevÃ¦gelsessensor | 15 kr |
| Jumper wires | 3 stk han-hun | 5 kr |
| **Total** | | **~65 kr** |

<Aside type="note" title="Hvad er PIR?">
**P**assive **I**nfra**R**ed - sensoren registrerer infrarÃ¸d strÃ¥ling (varme) fra mennesker og dyr. Den bruger ingen strÃ¸m til at "sende" - den lytter bare.
</Aside>

## ğŸ”Œ Tilslutning

### Wiring diagram

![PIR sensor til ESP32 wiring diagram](/images/guides/bevaegelsessensor/wiring.svg)

<Steps>
1. **RÃ¸d (VCC)** â†’ ESP32 **5V** eller **VIN** pin

2. **Gul (OUT/Signal)** â†’ ESP32 **GPIO5**

3. **Sort (GND)** â†’ ESP32 **GND**
</Steps>

<Aside type="tip">
HC-SR501 kÃ¸rer pÃ¥ 5V, men output-signalet er 3.3V kompatibelt, sÃ¥ det er sikkert at forbinde til ESP32.
</Aside>

## âš™ï¸ ESPHome Konfiguration

```yaml title="entre-sensor.yaml" {15-25}
esphome:
  name: entre-sensor
  friendly_name: EntrÃ© Sensor

esp32:
  board: esp32dev

logger:
api:
  encryption:
    key: "din-nÃ¸gle"
ota:
  platform: esphome

# PIR BevÃ¦gelsessensor
binary_sensor:
  - platform: gpio
    pin: GPIO5
    name: "EntrÃ© BevÃ¦gelse"
    device_class: motion
    filters:
      - delayed_off: 10s  # Hold "on" i 10 sek efter bevÃ¦gelse

# Valgfrit: Status LED
light:
  - platform: status_led
    name: "Status LED"
    pin: GPIO2

wifi:
  ssid: "dit-wifi"
  password: "din-kode"
```

<Aside type="tip" title="delayed_off filter">
`delayed_off: 10s` holder sensoren "on" i 10 sekunder efter sidste bevÃ¦gelse. Dette forhindrer at lys flimrer tÃ¦nd/sluk.
</Aside>

## ğŸ“¤ Upload og Test

<Steps>
1. Klik **INSTALL** â†’ **Wirelessly** (eller USB fÃ¸rste gang)

2. GÃ¥ til **Home Assistant** â†’ **UdviklervÃ¦rktÃ¸jer** â†’ **Tilstande**

3. SÃ¸g efter `binary_sensor.entre_bevaegelse`

4. GÃ¥ forbi sensoren - status skifter til **on**
</Steps>

## ğŸ”§ JustÃ©r PIR Sensoren

HC-SR501 har to smÃ¥ skruer du kan justere:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         â”‚
â”‚   [Time]     [Sens]     â”‚
â”‚     â†‘          â†‘        â”‚
â”‚   Varighed  FÃ¸lsomhed   â”‚
â”‚                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

| Skrue | Mod uret | Med uret |
|-------|----------|----------|
| **Time** | Kortere "on" tid (~3s) | LÃ¦ngere "on" tid (~5min) |
| **Sensitivity** | Kortere rÃ¦kkevidde (~3m) | LÃ¦ngere rÃ¦kkevidde (~7m) |

<Aside type="caution" title="Opvarmningstid">
PIR sensoren bruger ~60 sekunder pÃ¥ at kalibrere nÃ¥r den tÃ¦ndes. I denne periode kan den give falske alarmer.
</Aside>

## ğŸ¤– Automation: TÃ¦nd lys ved bevÃ¦gelse

### Simpel automation

```yaml title="automations.yaml"
automation:
  - alias: "TÃ¦nd entrÃ© lys ved bevÃ¦gelse"
    trigger:
      - platform: state
        entity_id: binary_sensor.entre_bevaegelse
        to: "on"
    action:
      - service: light.turn_on
        target:
          entity_id: light.entre
```

### Avanceret: Kun om natten

```yaml title="automations.yaml"
automation:
  - alias: "TÃ¦nd entrÃ© lys om natten"
    trigger:
      - platform: state
        entity_id: binary_sensor.entre_bevaegelse
        to: "on"
    condition:
      - condition: sun
        after: sunset
        before: sunrise
    action:
      - service: light.turn_on
        target:
          entity_id: light.entre
        data:
          brightness_pct: 50
      - delay: "00:02:00"
      - service: light.turn_off
        target:
          entity_id: light.entre
```

### Smart: Med timeout og dimning

```yaml title="automations.yaml"
automation:
  - alias: "Smart entre lys"
    mode: restart  # Genstart timer ved ny bevÃ¦gelse
    trigger:
      - platform: state
        entity_id: binary_sensor.entre_bevaegelse
        to: "on"
    action:
      - service: light.turn_on
        target:
          entity_id: light.entre
        data:
          brightness_pct: "{{ 30 if is_state('sun.sun', 'below_horizon') else 80 }}"
      - wait_for_trigger:
          - platform: state
            entity_id: binary_sensor.entre_bevaegelse
            to: "off"
            for: "00:02:00"
      - service: light.turn_off
        target:
          entity_id: light.entre
```

## ğŸ”§ Fejlfinding

<Aside type="tip" title="Sensoren trigger hele tiden?">
- UndgÃ¥ at pege sensoren mod vinduer (sollys)
- UndgÃ¥ varmekilder (radiatorer, computere)
- Reducer fÃ¸lsomheden med Sensitivity-skruen
- Tjek for bevÃ¦gelige objekter (gardiner, kÃ¦ledyr)
</Aside>

<Aside type="tip" title="Sensoren reagerer ikke?">
- Tjek at VCC er 5V (ikke 3.3V)
- Vent 60 sek efter opstart (kalibrering)
- Tjek at OUT-ledningen sidder i GPIO5
- Test med `delayed_off` filter fjernet
</Aside>

<Aside type="tip" title="For kort rÃ¦kkevidde?">
- Skru Sensitivity-skruen med uret
- HC-SR501 har maks ~7m rÃ¦kkevidde
- Overvej at tilfÃ¸je flere sensorer
</Aside>

## ğŸ’¡ Projekt-idÃ©er

| Projekt | Beskrivelse |
|---------|-------------|
| **Automatisk lys** | TÃ¦nd lys i gang/entrÃ© ved bevÃ¦gelse |
| **Sikkerheds-alarm** | Send notifikation nÃ¥r du er vÃ¦k |
| **Aktivitets-log** | Track hvornÃ¥r rum bruges |
| **Smart varme** | TÃ¦nd varme kun i brugte rum |

## ğŸš€ NÃ¦ste skridt

<CardGrid>
  <Card title="ğŸŒ¡ï¸ Temperatur sensor" icon="rocket">
    Kombiner med temperatur for komplet rum-sensor.
    
    [Byg temperatur sensor â†’](/da/esp32/temperatur-sensor/)
  </Card>
  <Card title="ğŸ’¡ LED Strip" icon="setting">
    TÃ¦nd LED strip ved bevÃ¦gelse for ambient lys.
    
    [Byg LED strip â†’](/da/esp32/led-strip/)
  </Card>
</CardGrid>
